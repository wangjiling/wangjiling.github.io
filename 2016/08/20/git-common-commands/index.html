<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Git常用命令</title>

  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="WEB前端学习分享" property="og:site_name">
  
    <meta content="Git常用命令" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="Git常用命令" property="og:description">
  
  
    <meta content="/2016/08/20/git-common-commands/" property="og:url">
  
  
    <meta content="2016-08-20T00:00:00+08:00" property="article:published_time">
    <meta content="/about/" property="article:author">
  
  
    <meta content="/assets/img/bookrack.jpeg" property="og:image">
  
  
    
  
  
    
    <meta content="Git" property="article:tag">
    
    <meta content="Learn" property="article:tag">
    
  

  
    <meta name="twitter:card" content="Git常用命令">
  
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
  
    <meta name="twitter:title" content="Git常用命令">
  
  
    <meta name="twitter:url" content="/2016/08/20/git-common-commands/">
  
  
    <meta name="twitter:description" content="Git常用命令">
  
  
    <meta name="twitter:image:src" content="/assets/img/bookrack.jpeg">
  

	<meta name="description" content="Git常用命令">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"
          ><img
            src="/assets/img/wang.png"
            alt="Wang Jiling"
        /></a>
      </div>
      <div class="author-name">Wang Jiling</div>
      <p>前端工程师，目前专注于大前端开发、架构</p>
    </div>
  </header>
  <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Contact me</h3>
      <ul>
        <!-- 
          <li><a href="https://twitter.com/wangjiling" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
        
        
          <li><a href="https://facebook.com/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
         -->
        
        <li class="github">
          <a href="https://github.com/wangjiling" target="_blank"
            ><i class="fa fa-github"></i
          ></a>
        </li>
        
        <!-- 
          <li class="linkedin"><a href="https://in.linkedin.com/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
         -->
        
        <li class="email">
          <a href="mailto:vincentwangjiling@gmail.com"
            ><i class="fa fa-envelope-o" aria-hidden="true"></i
          ></a>
        </li>
        
      </ul>
    </section>
    <!-- End Section Contact -->
    <div class="copyright">
      <p>2016-2019 &copy; Wang Jiling</p>
      <p>
        <a target="_blank" href="http://www.miitbeian.gov.cn"
          >沪ICP备17029424号</a
        >
      </p>
    </div>
  </footer>
  <!-- End Footer -->
</aside>
<!-- End Sidebar -->
<div class="content-box clearfix"><article class="article-page">
  <div class="page-content">
    
    <div class="page-cover-image">
      <img class="page-image" src=/assets/img/bookrack.jpeg alt="Git常用命令">
    </div> <!-- End Page Cover Image -->
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">Git常用命令</h1>
        <div class="page-date"><span>2016, Aug 20&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      <h3 id="前言">前言</h3>

<p>对于PG来说，VCS（版本控制系统）应该都很熟悉，可以帮助开发者同步工作，整合代码，维护历史版本。工作中陆续使用过Svn、Mercurial、Git，而最近的几年一直在使用Git。毫无疑问，目前Git是最流行的分布式版本控制系统。</p>

<p>最近两天回顾了一下开发中所用到的Git操作，并查阅了大量资料，重新系统性地梳理了Git相关知识。本文主要介绍工作中常用到的Git命令，旨在帮助理解这些命令，更好地运用到实际项目开发中，提升工作效率。</p>

<h3 id="cvcs-vs-dvcs">CVCS vs DVCS</h3>

<p>常见的VCS
	集中式版本控制系统（CVCS）：Subversion、CVS 、Perforce等
	分布式版本控制系统（DVCS）：Git、BitKeeper、Mercurial等
两张图，感受一下区别：CVCS－图1；DVCS：图2</p>

<p><img src="/assets/img/git-common-commands/cvcs.jpg" alt="cvcs" /></p>

<p>图1</p>

<p><img src="/assets/img/git-common-commands/dvcs.jpg" alt="dvcs" /></p>

<p>图2</p>

<p>Git 是 Linus Torvalds 为了帮助管理 Linux 内核开发而开发的一个开放源码的版本控制软件，是一款免费、开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。Git有以下优势：
    本地完整版本库
    自由和开放源码
    快速和小
    隐式备份
    安全
    更简单的分支</p>

<h3 id="git相关概念">Git相关概念</h3>

<p>分布式：Git是分布式版本控制系统，同一个Git仓库，可以分布到不同的机器上。最早，肯定只有一台机器有一个原始版本库，然后别的机器可以“克隆”这个原始版本库，而且每台机器的版本库其实都是一样的，并没有主次之分。之后各自把各自的提交推送到服务器仓库里，也从服务器仓库中拉取别人的提交。分布式版本系统的最大好处之一是在本地工作完全不需要考虑远程库的存在，也就是有没有联网都可以正常工作，而SVN在没有联网的时候是拒绝干活的。当有网络的时候，Git再把本地提交推送一下就完成了同步。</p>

<p>工作区（Working Directory）：就是你在电脑里能看到的目录。</p>

<p>版本库（Repository）：工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。Git的版本库里存了很多东西，其中最重要的就是称为Stage的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。</p>

<p><img src="/assets/img/git-common-commands/repository.jpg" alt="repository" /></p>

<p>我们把文件往Git版本库里添加的时候，是分两步执行的：
第一步是用git add把文件添加进去，实际上就是把文件修改添加到暂存区（Stage），文件修改后没有被add它的状态是Untracked；
第二步是用git commit提交更改，实际上就是把暂存区的所有内容提交到当前分支。</p>

<p>文件跟踪：Git跟踪并管理的是修改，而非文件。每次修改，如果不add到暂存区，就不会加入到commit中。</p>

<p>代码冲突：合并代码的时候，如果修改了同一个文件则可能会有冲突。如果有，Git会告诉哪些文件存在冲突，必须手动解决冲突后再提交。查看冲突的文件，Git用<code class="highlighter-rouge">&lt;&lt;&lt;&lt;&lt;&lt;&lt;，=======，&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>标记出不同分支的内容，修改冲突文件保存后再次提交，合并完成。</p>

<p>分支：每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。在Git里，默认分支叫主分支，即master分支。</p>

<p><img src="/assets/img/git-common-commands/header.jpg" alt="header" /></p>

<p>HEAD严格来说不是指向提交，而是指向当前分支，当前分支才是指向提交的。一开始的时候，master分支是一条线，Git用master指向最新的提交，再用HEAD指向master，就能确定当前分支，以及当前分支的提交点。</p>

<p>在实际开发中，应该按照几个基本原则进行分支管理：
master分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面开发；开发都在dev分支上，也就是说，dev分支是不稳定的，到某个时候，比如1.0版本发布时，再把dev分支合并到master上，在master分支发布1.0版本；你和你的小伙伴们每个人都在dev分支上干活，每个人都有自己的分支，时不时地往dev分支上合并就可以了。</p>

<p>开发中，bug就像家常便饭一样。有了bug就需要修复，在Git中，由于分支是如此的强大，所以，每个bug都可以通过一个新的临时分支来修复，修复后，合并分支，然后将临时分支删除。
开发一个新feature，最好新建一个分支；如果要丢弃一个没有被合并过的分支，可以通过git branch -D <name>强行删除。
master分支是主分支，因此要时刻与远程同步；
dev分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；
bug分支只用于在本地修复bug，就没必要推到远程了，除非老板要看看你每周到底修复了几个bug；
feature分支是否推到远程，取决于你是否和你的小伙伴合作在上面开发。</name></p>

<p><img src="/assets/img/git-common-commands/branch.jpg" alt="branch" /></p>

<p>多人协作的工作模式通常是这样：
首先，可以试图用git push origin branch-name推送自己的修改；
如果推送失败，则因为远程分支比你的本地更新，需要先用git pull试图合并；
如果合并有冲突，则解决冲突，并在本地提交；
没有冲突或者解决掉冲突后，再用git push origin branch-name推送就能成功！
如果git pull提示“no tracking information”，则说明本地分支和远程分支的链接关系没有创建，用命令git branch –set-upstream branch-name origin/branch-name。</p>

<p>忽略特殊文件：有些时候，你必须把某些文件放到Git工作目录中，但又不能提交它们，每次git status都会显示Untracked files …，在Git工作区的根目录下创建一个特殊的.gitignore文件，然后把要忽略的文件名填进去，Git就会自动忽略这些文件。
忽略文件的原则是：
忽略操作系统自动生成的文件，比如缩略图等；
忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如Java编译产生的.class文件；
忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。
1、配置语法：
　　以斜杠“/”开头表示目录；
　　以星号“<em>”通配多个字符；
　　以问号“?”通配单个字符
　　以方括号“[]”包含单个字符的匹配列表；
　　以叹号“!”表示不忽略(跟踪)匹配到的文件或目录；
　　此外，git 对于 .gitignore 配置文件是按行从上到下进行规则匹配的，意味着如果前面的规则匹配的范围更大，则后面的规则将不会生效；
2、示例：
　　（1）规则：fd1/</em>
		说明：忽略目录 fd1 下的全部内容；注意，不管是根目录下的 /fd1/ 目录，还是某个	子目录 /child/fd1/ 目录，都会被忽略；
　　（2）规则：/fd1/*
		说明：忽略根目录下的 /fd1/ 目录的全部内容；
　　（3）规则：
		/*
		!.gitignore
		!/fw/bin/
		!/fw/sf/
	说明：忽略全部内容，但是不忽略 .gitignore 文件、根目录下的 /fw/bin/ 和 /fw/sf/ 目录。</p>

<h3 id="git常用命令">Git常用命令</h3>

<p>git init：初始化一个Git仓库，当前目录下多了一个.git的目录，这个目录是Git来跟踪管理版本库的，没事千万不要手动修改这个目录里面的文件，不然改乱了，就把Git仓库给破坏了。</p>

<p>git clone repo_address [local_dir]：从远程克隆一个本地库，当你从远程仓库克隆时，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且远程仓库的默认名称是origin。该命令会在本地主机生成一个目录，与远程主机的版本库同名，如果要指定不同的目录名，可以将目录名作为git clone命令的第二个参数。</p>

<p>git add <file>：把文件添加到仓库，git add . 添加所有修改的文件到仓库。</file></p>

<p>git commit：把文件提交到仓库；每当你觉得文件修改到一定程度的时候，就可以“保存一个快照”，这个快照在Git中被称为commit。一旦你把文件改乱了，或者误删了文件，还可以从最近的一个commit恢复，然后继续工作，而不是把几个月的工作成果全部丢失。</p>

<p>git fetch <remote_name> <branch_name>：从远程获取最新版本到本地，不会自动merge；默认情况下，git fetch <remote_name> 取回所有分支（branch）的更新。如果只想取回特定分支的更新，可以指定分支名，所取回的更新，在本地主机上要用”远程主机名/分支名”的形式读取，比如origin主机的master，就要用origin/master读取。</remote_name></branch_name></remote_name></p>

<p>git pull <remote_name> <remote_branch_name>:<local_branch_name>：取回remote_name主机的remote_branch_name分支，与本地的local_branch_name分支合并，有冲突解决冲突，再进行提交、推送。如果远程分支是与当前分支合并，则冒号后面的部分可以省略；如果当前分支与远程分支存在追踪关系，git pull就可以省略远程分支名；如果当前分支只有一个追踪分支，连远程主机名都可以省略。</local_branch_name></remote_branch_name></remote_name></p>

<p>git push <remote_name> <local_branch_name>:<remote_branch_name>：把该分支上的所有本地提交推送到远程库，推送时，要指定本地分支，这样，Git就会把该分支推送到远程库对应的远程分支上，如：git push origin master。注意，分支推送顺序的写法是<来源地>:<目的地>，所以git pull是<远程分支>:<本地分支>，而git push是<本地分支>:<远程分支>。如果省略远程分支名，则表示将本地分支推送与之存在”追踪关系”的远程分支（通常两者同名），如果该远程分支不存在，则会被新建(git push origin master)。如果省略本地分支名，则表示删除指定的远程分支，因为这等同于推送一个空的本地分支到远程分支(git push origin :master等同于git push origin --delete master)。git push不会推送标签（tag），除非使用--tags选项。</远程分支></本地分支></本地分支></远程分支></目的地></来源地></remote_branch_name></local_branch_name></remote_name></p>

<p>git rm：用于删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失最近一次提交后你修改的内容。</p>

<p>git reset：–mixed(default) 改变HEAD和index，指向那个你要reset到的commit上，而working copy文件不被改变，当然会显示工作目录下有修改，但没有缓存到stage中；git reset –soft commit_id是回到某次提交，提交及之前的commit都会被保留，但是此次之后的修改都会被退回到暂存区；–hard：HEAD &amp; index &amp; working copy同时改变到你要reset到的那个commit上,这个参数很危险，执行了它，你的本地修改可能就丢失了。在Git中，用HEAD表示当前版本，上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100；Git的版本回退速度非常快，因为Git在内部有个指向当前分支的HEAD指针，当前分支指向最新的提交，当你回退版本的时候，Git仅仅是改变指针指向，然后顺便把工作区的文件更新了；用命令git reset HEAD file可以把暂存区的修改撤销掉（unstage），重新放回工作区；</p>

<p>git revert：生成一个新的提交来撤销某次提交，此次提交之前的commit都会被保留。</p>

<p>git branch：
1、git branch branch_name：创建新分支
2、git branch：列出所有分支，当前分支前面会标一个*号。
3、git branch -d branch_name：删除branch_name分支，-D 强行删除
因为创建、合并和删除分支非常快，所以Git鼓励你使用分支完成某个任务，合并后再删掉分支，这和直接在master分支上工作效果是一样的，但过程更安全。
4、git branch –set-upstream dev origin/dev，指定本地dev分支与远程origin/dev分支的链接</p>

<p>git checkout：
1、git checkout – file：把文件在工作区的修改全部撤销，这里有两种情况：一种是readme.txt自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态，一种是readme.txt已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。总之，就是让这个文件回到最近一次git commit或git add时的状态。
2、git checkout branch_name：切换到branch_name分支；git checkout -b branch_name：加上-b参数表示创建并切换到branch_name分支。
3、在本地创建和远程分支对应的分支，使用git checkout -b branch_name origin/branch_name，本地和远程分支的名称最好一致；</p>

<p>git merge：合并指定分支到当前分支，当Git无法自动合并分支时，就必须首先解决冲突，解决冲突后，再提交，合并完成；git merge –no-ff -m “merge with no-ff” dev通常，合并分支时，如果可能，Git会用Fast forward模式，但这种模式下，删除分支后，会丢掉分支信息。如果要强制禁用Fast forward模式（–no-ff 方式），Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。</p>

<p>git stash：把当前工作现场“储藏”起来，等以后恢复现场后继续工作。当手头工作没有完成时，先把工作现场git stash一下，然后去修复bug，修复后，再git stash pop，回到工作现场；git stash list，查看stash列表，恢复有两个办法：一是用git stash apply恢复，但是恢复后，stash内容并不删除，你需要用git stash drop来删除；另一种方式是用git stash pop，恢复的同时把stash内容也删了；git stash apply stash@{0}，恢复指定的stash。</p>

<p>git status：查看仓库当前的状态，了解文件的修改和提交状态。</p>

<p>git diff：查看文件具体修改了什么内容。</p>

<p>git log：查看从最近到最远的提交日志，按“q”键退出查看；如果嫌输出信息太多，看得眼花缭乱的，可以试试加上—pretty=oneline参数；可以用来查看提交历史，以便确定要回退到哪个版本；加上—graph参数可以看到分支合并图。</p>

<p>git reflog：查看你的每一次命令；在Git中，总是有后悔药可以吃的，当你用$ git reset –hard HEAD^回退到某个版本时，再想恢复到较新版本，就必须找到该交新版本对应的commit id，可以用此查看历史命令，以便确定要回到未来的哪个版本。</p>

<p>git remote ：
1、git remote add origin git@server-name:path/repo-name.git：关联一个远程库，关联后，使用命令git push -u origin master第一次推送master分支的所有内容，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，此后，每次本地提交后，只要有必要，就可以使用命令git push origin master推送最新修改；
2、git remote：查看远程库(远程主机)的信息，git remote -v显示更详细的信息</p>

<p>git tag：
1、git tag：查看所有标签
2、git tag tag_name：打一个新标签，默认标签是打在最新提交的commit上的
3、git tag tag_name commit_id：指定对某个提交打标签
4、git tag -d tag_name：删除标签
Git的标签虽然是版本库的快照，tag就是一个让人容易记住的有意义的名字，它跟某个commit绑在一起，可以用git show <tagname>查看标签信息.</tagname></p>

<h3 id="总结">总结</h3>

<p>Git虽然极其强大，命令繁多，但常用的就那么十来个，掌握好这些常用命令，你就已经可以得心应手地使用Git，工作效率必有大幅提升。</p>

      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=Git常用命令&url=/2016/08/20/git-common-commands/" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u=/2016/08/20/git-common-commands/" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url=/2016/08/20/git-common-commands/" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          
            <a href="/tags#Git" class="tag">&#35; Git</a>
          
            <a href="/tags#Learn" class="tag">&#35; Learn</a>
          
        </div>
      </div>
      <section class="comment-area">
  <!--PC和WAP自适应版-->
  <div id="SOHUCS" sid="/2016/08/20/git-common-commands"></div>
  <script type="text/javascript">
    (function () {
      var appid = "cytqkAhNv";
      var conf = "prod_6e8ce9f2b9b375457313cf45a53ca895";
      var width = window.innerWidth || document.documentElement.clientWidth;
      if (width < 960) {
        window.document.write(
          '<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' +
            appid +
            "&conf=" +
            conf +
            '"><\/script>'
        );
      } else {
        var loadJs = function (d, a) {
          var c =
            document.getElementsByTagName("head")[0] ||
            document.head ||
            document.documentElement;
          var b = document.createElement("script");
          b.setAttribute("type", "text/javascript");
          b.setAttribute("charset", "UTF-8");
          b.setAttribute("src", d);
          if (typeof a === "function") {
            if (window.attachEvent) {
              b.onreadystatechange = function () {
                var e = b.readyState;
                if (e === "loaded" || e === "complete") {
                  b.onreadystatechange = null;
                  a();
                }
              };
            } else {
              b.onload = a;
            }
          }
          c.appendChild(b);
        };
        loadJs("https://changyan.sohu.com/upload/changyan.js", function () {
          window.changyan.api.config({ appid: appid, conf: conf });
        });
      }
    })();
  </script>
</section>

    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->
</div>

  </div>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111688204-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-111688204-1');
</script>

<!-- baidu -->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?4203e28ed2486071d9be8be5ac2e99cd";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</body>
</html>
